向存储在 `键` 的有序集合中添加所有指定的成员与分数。
可以指定多个分数/成员对。
如果指定的成员已存在于有序集合，将对分数进行更新并重新将元素插入到指定的位置以确保排序正确。

如果 `键` 不存在，将创建一个新的有序集合并存入指定成员，如同有序集合为空一样。
如果键存在但值不是有序集合时，返回错误。

分数值应为一个表示双精浮点数的字符串。 `+inf` 和 `-inf` 也是合法的值。

ZADD的可选参数（Redis 3.0.2 或更新版本）
---

ZADD支持一系列可选参数，在键名之后、第一个分数参数之前指定。选项为：

* **XX**: 只更新已经存在的元素。不会添加元素。
* **NX**: 不更新已经存在的元素。只添加元素。
* **CH**: 返回值从添加的新元素数量变成改变的元素数量（CH是英文 *changed* 的缩写）。改变的元素包括 **新添加** 的和已经存在但 **更新了分数** 的元素。也就是说已经存在且分数没变的元素不算在内。注意：正常情况下 `ZADD` 的返回值只包括添加了的元素数量。
* **INCR**: `ZADD` 的这个选项类似于 `ZINCRBY` 。只能指定一个分数-元素对。

整型分数的表示精度范围
---

Redis有序集合使用 *双精度64位浮点数* 来表示分数。
在所有支持的架构中，其为 **IEEE 754 浮点数** ，可以表示整型数的范围是 `-(2^53)` 至 `+(2^53)` ，包含二者也就是闭区间。
更具体地说，所有在-9007199254740992 至 9007199254740992的整数都可以完美表示。
更大的整数、或小数，在内部以科学计数法表示，所以有可能设定分数后得到的是一个小数或非常大整数的近似值。

有序集合 101
---

有序集合的元素以分数进行升序排列。
相同元素只存在一个，不允许有重复元素。
使用 `ZADD` 和 `ZINCRBY` 都可以修改分数。 `ZADD` 更新分数的同时把元素放在有序集合的适当位置，  `ZINCRBY` 更新分数时会累计之前的值。

命令 `ZSCORE` 可以用来取得元素当前的分数，也可以判断元素是否存在。

关于有序集合的介绍，请参见数据类型文章中的[有序集合][tdtss]。

[tdtss]: /topics/data-types#sorted-sets

相同分数的元素
---

虽然有序集合不能重复出现相同元素，但不同元素可以  *具有相同的分数* 。
相同分数的元素使用 *字典排序* （它们仍然会先用分数进行排序，然后再用字典排序相对位置）。

排序的字典使用二进制，比较的是字符串的字节数组。

如果有序集合中插入所有元素的分数相同（比如0），所有元素将进行字典排序，并可以使用命令 `ZRANGEBYLEX` 范围查询元素（注：也可以使用 `ZRANGEBYSCORE` 通过分数区间查询）。

@return

@integer-reply, 具体为：

* 加入到有序集合中的元素数量，不包括已经存在并更新分数的元素。

@history

* `>= 2.4`: 接受多个元素。
  早于2.4版本的Redis只可以一次添加或更新一个成员。

@examples

```cli
ZADD myzset 1 "one"
ZADD myzset 1 "uno"
ZADD myzset 2 "two" 3 "three"
ZRANGE myzset 0 -1 WITHSCORES
```
